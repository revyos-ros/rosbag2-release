From 2fad118f864b4b8bd0c978c06b097f5c7f53aa76 Mon Sep 17 00:00:00 2001
From: Zheng Junjie <zhengjunjie@iscas.ac.cn>
Date: Fri, 26 Apr 2024 14:26:41 +0800
Subject: [PATCH 1/2] add some pathc to fix build.

---
 debian/patches/add-initialize.patch     | 22 ++++++++++++++++++++++
 debian/patches/add-missing-header.patch | 12 ++++++++++++
 debian/patches/series                   |  2 ++
 3 files changed, 36 insertions(+)
 create mode 100644 debian/patches/add-initialize.patch
 create mode 100644 debian/patches/add-missing-header.patch
 create mode 100644 debian/patches/series

diff --git a/debian/patches/add-initialize.patch b/debian/patches/add-initialize.patch
new file mode 100644
index 000000000..0fdd7a315
--- /dev/null
+++ b/debian/patches/add-initialize.patch
@@ -0,0 +1,22 @@
+see https://github.com/ros2/rosbag2/pull/1546
+
+diff --git a/include/rosbag2_compression/compression_options.hpp b/include/rosbag2_compression/compression_options.hpp
+index 37fe5007e..68f59416f 100644
+--- a/include/rosbag2_compression/compression_options.hpp
++++ b/include/rosbag2_compression/compression_options.hpp
+@@ -56,10 +56,11 @@ ROSBAG2_COMPRESSION_PUBLIC std::string compression_mode_to_string(CompressionMod
+  */
+ struct CompressionOptions
+ {
+-  std::string compression_format;
+-  CompressionMode compression_mode;
+-  uint64_t compression_queue_size;
+-  uint64_t compression_threads;
++  std::string compression_format{};
++  CompressionMode compression_mode{CompressionMode::NONE};
++  uint64_t compression_queue_size{0};
++  /// \brief // The number of compression threads
++  uint64_t compression_threads{0};
+ };
+ 
+ }  // namespace rosbag2_compression
diff --git a/debian/patches/add-missing-header.patch b/debian/patches/add-missing-header.patch
new file mode 100644
index 000000000..31822e983
--- /dev/null
+++ b/debian/patches/add-missing-header.patch
@@ -0,0 +1,12 @@
+diff --git a/include/rosbag2_compression/compression_options.hpp b/include/rosbag2_compression/compression_options.hpp
+index 68f59416f..a227ebb54 100644
+--- a/include/rosbag2_compression/compression_options.hpp
++++ b/include/rosbag2_compression/compression_options.hpp
+@@ -16,6 +16,7 @@
+ #define ROSBAG2_COMPRESSION__COMPRESSION_OPTIONS_HPP_
+ 
+ #include <string>
++#include <cstdint>
+ 
+ #include "visibility_control.hpp"
+ 
diff --git a/debian/patches/series b/debian/patches/series
new file mode 100644
index 000000000..cc4c858f7
--- /dev/null
+++ b/debian/patches/series
@@ -0,0 +1,2 @@
+add-initialize.patch
+add-missing-header.patch
-- 
2.41.0

